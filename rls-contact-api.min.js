(function(window){'use strict';const RLSContact={config:{apiUrl:'https://rls-contact-form-d3bbb0f6avhtgxb5.eastus-01.azurewebsites.net',siteId:null,useRedirect:true,debug:false},init:function(options){if(!options||!options.siteId){throw new Error('RLSContact: siteId is required');}this.config=Object.assign(this.config,options);this.log('Initialized with config:',this.config);this.autoAttach();},submit:function(formData,options={}){const config=Object.assign({},this.config,options);if(!config.siteId){throw new Error('RLSContact: siteId not configured');}this.log('Submitting form data:',formData);const url=`${config.apiUrl}/api/v1/contact/${config.siteId}`;const urlEncodedData=new URLSearchParams();for(const[key,value]of Object.entries(formData)){if(value!==null&&value!==undefined){urlEncodedData.append(key,value);}}if(!formData._hp){urlEncodedData.append('_hp','');}return fetch(url,{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:urlEncodedData.toString()}).then(response=>{this.log('Response received:',response);if(response.ok){if(response.status===303&&config.useRedirect){const location=response.headers.get('Location');if(location){window.location.href=location;return{success:true,redirected:true,location:location};}}return{success:true,status:response.status};}else{return response.text().then(errorText=>{throw new Error(`Server error: ${response.status} - ${errorText}`);});}});},submitForm:function(form,options={}){const formData=this.extractFormData(form);return this.submit(formData,options);},extractFormData:function(form){const formData=new FormData(form);const data={};for(const[key,value]of formData.entries()){data[key]=value;}return data;},autoAttach:function(){const forms=document.querySelectorAll('form[data-rls-contact]');forms.forEach(form=>{this.log('Auto-attaching to form:',form);this.attachToForm(form);});},attachToForm:function(form,options={}){const config=Object.assign({},this.config,options);const siteId=form.dataset.rlsContact||config.siteId;const useRedirect=form.dataset.rlsRedirect!=='false';const onSuccess=form.dataset.rlsOnSuccess;const onError=form.dataset.rlsOnError;form.addEventListener('submit',(e)=>{e.preventDefault();const submitBtn=form.querySelector('button[type="submit"], input[type="submit"]');const originalText=submitBtn?submitBtn.textContent:'';if(submitBtn){submitBtn.disabled=true;submitBtn.textContent='Sending...';}this.submitForm(form,{siteId:siteId,useRedirect:useRedirect}).then(result=>{this.log('Form submitted successfully:',result);if(result.redirected){return;}form.reset();if(onSuccess){if(typeof window[onSuccess]==='function'){window[onSuccess](result);}}else{this.showMessage(form,'Message sent successfully!','success');}}).catch(error=>{this.log('Form submission failed:',error);if(onError){if(typeof window[onError]==='function'){window[onError](error);}}else{this.showMessage(form,error.message,'error');}}).finally(()=>{if(submitBtn){submitBtn.disabled=false;submitBtn.textContent=originalText;}});});},showMessage:function(form,message,type){const existingMessage=form.querySelector('.rls-contact-message');if(existingMessage){existingMessage.remove();}const messageEl=document.createElement('div');messageEl.className=`rls-contact-message rls-contact-${type}`;messageEl.textContent=message;messageEl.style.cssText=`padding: 10px;margin: 10px 0;border-radius: 4px;border: 1px solid;${type==='success'?'background-color: #d4edda; border-color: #c3e6cb; color: #155724;':'background-color: #f8d7da; border-color: #f5c6cb; color: #721c24;'}`;form.parentNode.insertBefore(messageEl,form.nextSibling);setTimeout(()=>{if(messageEl.parentNode){messageEl.remove();}},5000);},validate:function(formData){const errors=[];if(!formData.email||!formData.email.trim()){errors.push('Email is required');}else if(!this.isValidEmail(formData.email)){errors.push('Please enter a valid email address');}if(!formData.message||!formData.message.trim()){errors.push('Message is required');}return{isValid:errors.length===0,errors:errors};},isValidEmail:function(email){const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return emailRegex.test(email);},log:function(...args){if(this.config.debug){console.log('[RLSContact]',...args);}}};window.RLSContact=RLSContact;document.addEventListener('DOMContentLoaded',function(){if(window.RLSContactConfig){RLSContact.init(window.RLSContactConfig);}});})(window);